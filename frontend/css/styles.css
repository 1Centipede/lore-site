/* =========================================================
 *  DESIGN TOKENS
 *  (Theme variables; tweak here to restyle globally)
 * =======================================================*/
:root {
  --bg:       #0f1221;
  --card:     #161a2b;
  --card-2:   #1b2036;

  --text:     #e7e9ff;
  --muted:    #a6accd;

  --accent:   #7b6ef6;
  --accent-2: #6356d2;

  --success:  #27ae60;
  --danger:   #d7263d;
  --ring:     #8ea0ff;

  --shadow:   0 8px 24px rgba(4, 8, 26, .35),
              0 2px 6px  rgba(4, 8, 26, .20);
}

/* =========================================================
 *  BASE / RESET
 * =======================================================*/
* {
  box-sizing: border-box;
}

html,
body {
  height: 100%;
  margin: 0;

  color: var(--text);
  font-family:
    ui-sans-serif, system-ui, -apple-system,
    Segoe UI, Roboto, "Gill Sans",
    "Helvetica Neue", Arial;

  /* Subtle space-y background */
  background:
    radial-gradient(1200px 600px at 20% -10%, #20264b 0%, #0f1221 55%) no-repeat fixed,
    var(--bg);
}

/* =========================================================
 *  LAYOUT UTILITIES
 * =======================================================*/
.divider {
  width: 1px;
  height: 20px;
  background: rgba(255, 255, 255, .12);
}

/* =========================================================
 *  HEADER
 * =======================================================*/
.site-header {
  position: sticky;
  top: 0;
  z-index: 30;

  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;

  padding: 16px 20px;

  background: linear-gradient(180deg, rgba(15, 18, 33, .95), rgba(15, 18, 33, .80));
  backdrop-filter: blur(8px);
  border-bottom: 1px solid rgba(255, 255, 255, .06);
}

.site-header h1 {
  padding-left: 40%;
  margin: 0;
  font-weight: 800;
  letter-spacing: .2px;
  font-size: clamp(20px, 2.4vw, 28px);
}

.header-actions {
  display: flex;
  gap: 8px;
}

/* =========================================================
 *  TOOLBAR (view controls)
 *  Shown only in mobile-zoom mode (see overrides at bottom)
 * =======================================================*/
.toolbar {
  display: none; /* default hidden; enabled under .mobile-zoom */
  align-items: center;
  justify-content: space-between;
  gap: 12px;

  padding: 10px 16px;
  border-bottom: 1px solid rgba(255, 255, 255, .06);
}

.hint {
  color: var(--muted);
  font-size: 13px;
}

.toolbar-right {
  display: flex;
  align-items: center;
  gap: 8px;
}

.zoom-label {
  min-width: 52px;
  text-align: center;
  color: var(--muted);
}

/* =========================================================
 *  STAGE (viewport container) & ZOOM WRAPPER
 * =======================================================*/
.stage {
  position: relative;
  overflow: visible; /* desktop: show full content */

  max-width: 1500px;
  margin: 12px auto 22px;
  border-radius: 18px;

  background: linear-gradient(180deg, rgba(255, 255, 255, .03), rgba(255, 255, 255, .02));
  border: 1px solid rgba(255, 255, 255, .08);
  box-shadow: var(--shadow);
}

.zoom-content {
  position: relative; /* desktop: normal flow */
  transform: none;
}

.tree-lines {
  position: absolute;
  inset: 0;
  pointer-events: none; /* allow interactions through lines layer */
}

/* =========================================================
 *  GRID (family tree layout)
 *  Keep desktop-like structure; mobile pans/zooms instead of reflow
 * =======================================================*/
.family-tree-grid {
  position: relative;

  display: grid;
  grid-template-columns: repeat(4, 280px);
  grid-auto-rows: auto;
  gap: 32px 40px;

  justify-items: center;
  align-items: start;

  padding: 28px 32px 40px;
  width: max-content;
  margin: 0 auto;
}

/* =========================================================
 *  CARDS & PAIRS
 * =======================================================*/
.grandparent-pair {
  grid-row: 1;
  grid-column: span 2;

  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 14px;

  padding: 18px 18px 20px;

  background: var(--card);
  border: 1px solid rgba(255, 255, 255, .06);
  border-radius: 16px;
  box-shadow: var(--shadow);
}

.pair-content {
  display: flex;
  gap: 16px;
}

.pair-title {
  margin: 0;
  color: var(--muted);
}

.card {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;

  width: 280px;
  padding: 16px;

  background: linear-gradient(180deg, var(--card-2), var(--card));
  border: 1px solid rgba(255, 255, 255, .06);
  border-radius: 14px;
}

.card-title {
  margin: 0;
  color: var(--muted);
}

/* =========================================================
 *  GRID POSITIONS (parents / child)
 * =======================================================*/
.parent-box {
  display: flex;
  justify-content: center;
  align-items: center;
}

#parent1-box {
  grid-column: 2 / 3;
  grid-row: 2;
}

#parent2-box {
  grid-column: 3 / 4;
  grid-row: 2;
}

.child-box {
  grid-column: 2 / 4;
  grid-row: 3;

  display: flex;
  justify-content: center;
}

/* =========================================================
 *  CANVAS (sprite preview)
 * =======================================================*/
canvas {
  image-rendering: pixelated;   /* avoid blur for pixel art */
  image-rendering: crisp-edges;

  background: #0d1020;
  border: 1px solid rgba(255, 255, 255, .08);
  border-radius: 12px;

  /* inner border + depth */
  box-shadow:
    inset 0 0 0 1px rgba(255, 255, 255, .03),
    0 8px 16px rgba(0, 0, 0, .35);
}

/* =========================================================
 *  BUTTONS
 * =======================================================*/
.btn {
  padding: 8px 12px;

  border: none;
  border-radius: 10px;

  background: var(--card-2);
  color: var(--text);
  font-weight: 700;
  cursor: pointer;

  transition:
    transform .06s ease,
    background .18s ease,
    box-shadow .18s ease;

  box-shadow: 0 2px 10px rgba(0, 0, 0, .25);
}

.btn:hover {
  transform: translateY(-1px);
}

.btn:active {
  transform: translateY(0) scale(.98);
}

.btn:focus-visible {
  outline: 2px solid var(--ring);
  outline-offset: 2px;
}

/* Variants */
.btn.primary {
  background: var(--accent);
}
.btn.primary:hover {
  background: var(--accent-2);
}

.btn.love {
  background: linear-gradient(90deg, #f65c9a, #f29b64);
}
.btn.love:hover {
  filter: brightness(1.05);
}

.btn.success {
  background: var(--success);
}
.btn.success:hover {
  filter: brightness(1.05);
}

.btn.danger {
  background: var(--danger);
}

.btn.subtle {
  background: #222844;
}

/* =========================================================
 *  TRAITS (chips + panels)
 * =======================================================*/
.traitText {
  margin: 0;
  align-self: stretch;

  padding: 10px 12px;
  font-size: 14px;
  color: var(--muted);

  background: rgba(255, 255, 255, .04);
  border: 1px solid rgba(255, 255, 255, .08);
  border-radius: 10px;
}

.traits-display {
  margin: 0;
  align-self: stretch;

  padding: 10px 12px;
  font-size: 14px;

  background: rgba(39, 174, 96, .12);
  border: 1px solid rgba(39, 174, 96, .25);
  border-radius: 10px;
}

.traitSelect {
  align-self: stretch;
}

.traitSelect label {
  display: block;
  margin: 6px 0 6px;

  color: var(--muted);
  font-size: 13px;
}

.dropdownTraits {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.dropdownTraits button {
  padding: 6px 10px;

  color: var(--text);
  font-weight: 600;
  cursor: pointer;

  background: rgba(255, 255, 255, .03);
  border: 1px solid rgba(255, 255, 255, .14);
  border-radius: 999px;

  transition:
    background .15s ease,
    border-color .15s ease,
    transform .06s ease;
}

.dropdownTraits button:hover {
  background: rgba(255, 255, 255, .08);
}

.dropdownTraits button.activeTrait {
  background: rgba(123, 110, 246, .25);
  border-color: var(--accent);
}

/* =========================================================
 *  FOOTER
 * =======================================================*/
.site-footer {
  text-align: center;
  color: var(--muted);
  padding: 10px 0 24px;
}

/* =========================================================
 *  MISC / STATES
 * =======================================================*/
button {
  font-size: 14px;
}

button:disabled {
  opacity: .6;
  cursor: not-allowed;
}

/* =========================================================
 *  MOBILE OVERRIDES (enabled when <body> has .mobile-zoom)
 *  Why: On mobile we pan/zoom the entire stage instead of reflowing the grid.
 * =======================================================*/
.mobile-zoom .toolbar {
  display: flex;
}

.mobile-zoom .stage {
  position: relative;
  height: min(78vh, 900px);
  overflow: hidden; /* contain panning content */
}

.mobile-zoom .zoom-content {
  position: absolute;
  inset: 0;
  transform-origin: 0 0; /* stable zooming */
}
